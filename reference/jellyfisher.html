<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Creates a Jellyfish plot — jellyfisher • jellyfisher</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a Jellyfish plot — jellyfisher"><meta name="description" content="Creates a Jellyfish plot from samples, a phylogeny, and subclonal compositions."><meta property="og:description" content="Creates a Jellyfish plot from samples, a phylogeny, and subclonal compositions."><meta property="og:image" content="https://hautaniemilab.github.io/jellyfisher/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jellyfisher</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to Jellyfisher</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HautaniemiLab/jellyfisher/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Creates a Jellyfish plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/HautaniemiLab/jellyfisher/blob/main/R/jellyfisher.R" class="external-link"><code>R/jellyfisher.R</code></a></small>
      <div class="d-none name"><code>jellyfisher.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a Jellyfish plot from samples, a phylogeny, and subclonal compositions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jellyfisher</span><span class="op">(</span></span>
<span>  <span class="va">tables</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ranks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  controls <span class="op">=</span> <span class="st">"closed"</span>,</span>
<span>  width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  elementId <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tables">tables<a class="anchor" aria-label="anchor" href="#arg-tables"></a></dt>
<dd><p>A named list of data frames. The list must contain the following elements:</p><dl><dt><code>samples</code></dt>
<dd><p>A data frame with sample data. The expected columns are:</p><dl><dt>sample</dt>
<dd><p>specifies the unique identifier for each sample. (string)</p></dd>

<dt>displayName</dt>
<dd><p>allows for specifying a custom name for each sample. If the column is omitted, the <code>sample</code> column is used as the display name. (string, optional)</p></dd>

<dt>rank</dt>
<dd><p>specifies the position of each sample in the Jellyfish plot. For example, different stages of a disease can be ranked in chronological order: diagnosis (1), interval (2), and relapse (3). The zeroth rank is reserved for the root of the sample tree. Ranks can be any integer, and unused ranks are automatically excluded from the plot. If the <code>rank</code> column is (integer)</p></dd>

<dt>parent</dt>
<dd><p>identifies the parent sample for each entry. Samples without a specified parent are treated as children of an imaginary root sample. (string)</p></dd>


</dl></dd>

<dt><code>phylogeny</code></dt>
<dd><p>A data frame with phylogeny data. The expected columns are:</p><dl><dt>subclone</dt>
<dd><p>specifies subclone IDs, which can be any string. (string)</p></dd>

<dt>parent</dt>
<dd><p>designates the parent subclone. The subclone without a parent is considered the root of the phylogeny. (string)</p></dd>

<dt>color</dt>
<dd><p>specifies the color for the subclone. If the column is omitted, colors will be generated automatically. (string, optional)</p></dd>

<dt>branchLength</dt>
<dd><p>specifies the length of the branch leading to the subclone. The length may be based on, for example, the number of unique mutations in the subclone. The branch length is shown in the Jellyfish plot's legend as a bar chart. It is also used when generating a phylogeny-aware color scheme. (number)</p></dd>


</dl></dd>

<dt><code>compositions</code></dt>
<dd><p>A data frame with subclonal compositions. The expected columns are:</p><dl><dt>sample</dt>
<dd><p>specifies the sample ID. (string)</p></dd>

<dt>subclone</dt>
<dd><p>specifies the subclone ID. (string)</p></dd>

<dt>clonalPrevalence</dt>
<dd><p>specifies the clonal prevalence of the subclone in the sample. The clonal prevalence is the proportion of the subclone in the sample. The clonal prevalences in a sample must sum to 1. (number)</p></dd>


</dl></dd>

<dt><code>ranks</code></dt>
<dd><p>An optional data frame with ranks. The expected columns are:</p><dl><dt>rank</dt>
<dd><p>specifies the rank number. The zeroth rank is reserved for the inferred root of the sample tree. However, you are free to define a title for it. (integer)</p></dd>

<dt>title</dt>
<dd><p>specifies the title for the rank. (string)</p></dd>


</dl></dd>


</dl></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>A named list of options to configure the plot. Available options:</p><dl><dt>bellTipShape</dt>
<dd><p>The shape of the bell tip. 0 is a sharp tip, 1 is a blunt tip. Defaults to <code>0.1</code>.</p></dd>

<dt>bellTipSpread</dt>
<dd><p>How much to spread nested bell tips. 0 is no spread, 1 is full spread. Defaults to <code>0.5</code>.</p></dd>

<dt>bellStrokeWidth</dt>
<dd><p>The width of strokes in the bell. Defaults to <code>1</code>.</p></dd>

<dt>bellPlateauPos</dt>
<dd><p>Where the bell has fully appeared and the plateau starts. Defaults to <code>0.75</code>.</p></dd>

<dt>sampleHeight</dt>
<dd><p>Height of real sample nodes Defaults to <code>110</code>.</p></dd>

<dt>sampleWidth</dt>
<dd><p>Width of sample nodes Defaults to <code>90</code>.</p></dd>

<dt>inferredSampleHeight</dt>
<dd><p>Height of inferred sample nodes Defaults to <code>120</code>.</p></dd>

<dt>gapHeight</dt>
<dd><p>Height of gaps between samples. Gaps are routes for tentacle bundles. Defaults to <code>60</code>.</p></dd>

<dt>sampleSpacing</dt>
<dd><p>Vertical space between samples Defaults to <code>60</code>.</p></dd>

<dt>columnSpacing</dt>
<dd><p>Horizontal space between columns Defaults to <code>90</code>.</p></dd>

<dt>tentacleWidth</dt>
<dd><p>Width of tentacles in pixels Defaults to <code>2</code>.</p></dd>

<dt>tentacleSpacing</dt>
<dd><p>Space between tentacles in a bundle, in pixels Defaults to <code>5</code>.</p></dd>

<dt>inOutCPDistance</dt>
<dd><p>Relative distance of tentacle control points from the edge of the sample node Defaults to <code>0.3</code>.</p></dd>

<dt>bundleCPDistance</dt>
<dd><p>Relative distance of tentacle bundle's control points. The higher the value, the longer the individual tentacles stay together before diverging. Defaults to <code>0.6</code>.</p></dd>

<dt>sampleFontSize</dt>
<dd><p>Font size for sample labels Defaults to <code>12</code>.</p></dd>

<dt>showLegend</dt>
<dd><p>Whether to show the legend Defaults to <code>TRUE</code>.</p></dd>

<dt>phylogenyColorScheme</dt>
<dd><p>Whether to use a color scheme based on phylogeny Defaults to <code>TRUE</code>.</p></dd>

<dt>phylogenyHueOffset</dt>
<dd><p>Offset for the hue of the phylogeny color scheme. If the automatically generated hues are not to your liking, you can adjust the hue offset to get a different color scheme. Defaults to <code>0</code>.</p></dd>

<dt>sampleTakenGuide</dt>
<dd><p>Type of the "sample taken" guide. <code>"none"</code> for no guides, <code>"line"</code> for a faint dashed line in all samples, <code>"text"</code> same as line, but with a text label in one of the samples. Defaults to <code>"text"</code>.</p></dd>

<dt>showRankTitles</dt>
<dd><p>Whether to show rank titles above the samples (if provided). Defaults to <code>TRUE</code>.</p></dd>

<dt>normalsAtPhylogenyRoot</dt>
<dd><p>Whether the root of the phylogenetic tree contains normal cells. If true, no tentacles will be drawn for the root clone and its color will be white if phylogenyColorScheme is used. Defaults to <code>FALSE</code>.</p></dd>


</dl></dd>


<dt id="arg-controls">controls<a class="anchor" aria-label="anchor" href="#arg-controls"></a></dt>
<dd><p>An optional parameter to set the initial state of the controls. Can be "open", "closed", or "hidden".</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>The width of the widget</p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>The height of the widget</p></dd>


<dt id="arg-elementid">elementId<a class="anchor" aria-label="anchor" href="#arg-elementid"></a></dt>
<dd><p>An optional element ID for the widget</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The format of the data frames is described with examples in Jellyfish documentation:
https://github.com/HautaniemiLab/jellyfish?tab=readme-ov-file#input-data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Plot the bundled example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">jellyfisher</span><span class="op">(</span><span class="va">jellyfish_example_tables</span>,</span></span>
<span class="r-in"><span>            options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>              sampleHeight <span class="op">=</span> <span class="fl">70</span>,</span></span>
<span class="r-in"><span>              sampleTakenGuide <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>              showLegend <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>            <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'jellyfish_example_tables' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kari Lavikka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

