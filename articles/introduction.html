<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to Jellyfisher • jellyfisher</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Jellyfisher">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jellyfisher</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to Jellyfisher</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HautaniemiLab/jellyfisher/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="introduction_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="introduction_files/jellyfish-0/lib.css" rel="stylesheet">
<script src="introduction_files/jellyfish-0/jellyfish.umd.js"></script><script src="introduction_files/jellyfisher-binding-0.0.0.9000/jellyfisher.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to Jellyfisher</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HautaniemiLab/jellyfisher/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HautaniemiLab/jellyfisher" class="external-link">jellyfisher</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Jellyfisher</strong> is an R package (a <a href="https://www.htmlwidgets.org/" class="external-link">htmlwidget</a>) for visualizing
tumor evolution and subclonal compositions using Jellyfish plots. The
package is based on the <a href="https://github.com/HautaniemiLab/jellyfish" class="external-link">Jellyfish</a>
visualization tool, bringing its functionality to R users. Jellyfisher
supports both <a href="https://github.com/hdng/clonevol" class="external-link">ClonEvol</a>
results and plain data frames, making it compatible with various tools
and workflows.</p>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The input data should follow specific structures for
<em>samples</em>, <em>phylogeny</em>, subclonal <em>compositions</em>,
and optional <em>ranks</em>.</p>
<p>The Jellyfisher package includes an example data set based on the
following publication: Lahtinen, A., Lavikka, K., Virtanen, A., et
al. “Evolutionary states and trajectories characterized by distinct
pathways stratify patients with ovarian high-grade serous carcinoma.”
<em>Cancer Cell</em> <strong>41</strong>, 1103–1117.e12 (2023). DOI: <a href="https://doi.org/10.1016/j.ccell.2023.04.017" class="external-link">10.1016/j.ccell.2023.04.017</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="samples">Samples<a class="anchor" aria-label="anchor" href="#samples"></a>
</h3>
<ul>
<li>
<code>sample</code> (string): specifies the unique identifier for
each sample.</li>
<li>
<code>displayName</code> (string, optional): allows for specifying a
custom name for each sample. If the column is omitted, the
<code>sample</code> column is used as the display name.</li>
<li>
<code>rank</code> (integer): specifies the position of each sample
in the Jellyfish plot. For example, different stages of a disease can be
ranked in chronological order: diagnosis (1), interval (2), and relapse
(3). The zeroth rank is reserved for the root of the sample tree. Ranks
can be any integer, and unused ranks are automatically excluded from the
plot. If the <code>rank</code> column is absent, ranks are assigned
based on each sample’s depth in the sample tree.</li>
<li>
<code>parent</code> (string): identifies the parent sample for each
entry. Samples without a specified parent are treated as children of an
imaginary root sample.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">$</span><span class="va">samples</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    sample displayName rank               parent patient</span></span>
<span><span class="co">#&gt; 35       EOC69_pOme1_DNA1       pOme1    1                        EOC69</span></span>
<span><span class="co">#&gt; 36       EOC69_pOva1_DNA2       pOva1    1                        EOC69</span></span>
<span><span class="co">#&gt; 37      EOC69_r1Vag1_DNA1      r1Vag1   10                        EOC69</span></span>
<span><span class="co">#&gt; 257     EOC495_pLNL1_DNA1       pLNL1    1                       EOC495</span></span>
<span><span class="co">#&gt; 258     EOC495_pLNL2_DNA1       pLNL2    1                       EOC495</span></span>
<span><span class="co">#&gt; 259      EOC495_pLNR_DNA1        pLNR    1                       EOC495</span></span>
<span><span class="co">#&gt; 260    EOC495_pOvaL6_DNA1      pOvaL6    1                       EOC495</span></span>
<span><span class="co">#&gt; 261    EOC495_pOvaL7_DNA1      pOvaL7    1                       EOC495</span></span>
<span><span class="co">#&gt; 262     EOC495_pPerL_DNA1       pPerL    1                       EOC495</span></span>
<span><span class="co">#&gt; 317      EOC677_pAsc_DNA1        pAsc    1                       EOC677</span></span>
<span><span class="co">#&gt; 318      EOC677_pPer1_DNA       pPer1    1                       EOC677</span></span>
<span><span class="co">#&gt; 319      EOC677_r2Asc_DNA       r2Asc   11     EOC677_rAsc_DNA4  EOC677</span></span>
<span><span class="co">#&gt; 320      EOC677_rAsc_DNA4        rAsc    9     EOC677_pAsc_DNA1  EOC677</span></span>
<span><span class="co">#&gt; 363  EOC809_p2Bow1_c_DNA2    p2Bow1_c    3                       EOC809</span></span>
<span><span class="co">#&gt; 364  EOC809_p2Ome1_c_DNA1    p2Ome1_c    3                       EOC809</span></span>
<span><span class="co">#&gt; 365 EOC809_p2OvaL1_c_DNA6   p2OvaL1_c    3                       EOC809</span></span>
<span><span class="co">#&gt; 366 EOC809_p2Per1_cO_DNA2   p2Per1_cO    3                       EOC809</span></span>
<span><span class="co">#&gt; 367    EOC809_r1Bow1_DNA1      r1Bow1   10 EOC809_p2Bow1_c_DNA2  EOC809</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="phylogeny">Phylogeny<a class="anchor" aria-label="anchor" href="#phylogeny"></a>
</h3>
<ul>
<li>
<code>subclone</code> (string): specifies subclone IDs, which can be
any string.</li>
<li>
<code>parent</code> (string): designates the parent subclone. The
subclone without a parent is considered the root of the phylogeny.</li>
<li>
<code>color</code> (string, optional): specifies the color for the
subclone. If the column is omitted, colors will be generated
automatically.</li>
<li>
<code>branchLength</code> (number): specifies the length of the
branch leading to the subclone. The length may be based on, for example,
the number of unique mutations in the subclone. The branch length is
shown in the Jellyfish plot’s legend as a bar chart. It is also used
when generating a phylogeny-aware color scheme.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">$</span><span class="va">phylogeny</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt;     subclone parent   color branchLength patient</span></span>
<span><span class="co">#&gt; 44         1     -1 #cccccc         2742   EOC69</span></span>
<span><span class="co">#&gt; 45         2     12 #a6cee3          478   EOC69</span></span>
<span><span class="co">#&gt; 46         5      9 #ff99ff           68   EOC69</span></span>
<span><span class="co">#&gt; 47         6      5 #fdbf6f          244   EOC69</span></span>
<span><span class="co">#&gt; 48         8      1 #bbbb77         2433   EOC69</span></span>
<span><span class="co">#&gt; 49         9      8 #cf8d30          313   EOC69</span></span>
<span><span class="co">#&gt; 50        11      8 #ff7f00          868   EOC69</span></span>
<span><span class="co">#&gt; 51        12      1 #3de4c5         4762   EOC69</span></span>
<span><span class="co">#&gt; 52        13      9 #ff1aff         1017   EOC69</span></span>
<span><span class="co">#&gt; 411        1     -1 #cccccc         1426  EOC495</span></span>
<span><span class="co">#&gt; 412        2      5 #a6cee3          184  EOC495</span></span>
<span><span class="co">#&gt; 413        3      6 #b2df8a          246  EOC495</span></span>
<span><span class="co">#&gt; 414        4      1 #cab2d6         2874  EOC495</span></span>
<span><span class="co">#&gt; 415        5      7 #ff99ff          864  EOC495</span></span>
<span><span class="co">#&gt; 416        6      5 #fdbf6f          154  EOC495</span></span>
<span><span class="co">#&gt; 417        7      1 #fb9a99          179  EOC495</span></span>
<span><span class="co">#&gt; 418        8      7 #bbbb77          631  EOC495</span></span>
<span><span class="co">#&gt; 419        9      4 #cf8d30          415  EOC495</span></span>
<span><span class="co">#&gt; 501        1     -1 #cccccc         4961  EOC677</span></span>
<span><span class="co">#&gt; 502        2      1 #a6cee3          239  EOC677</span></span>
<span><span class="co">#&gt; 503        4      5 #cab2d6          437  EOC677</span></span>
<span><span class="co">#&gt; 504        5     10 #ff99ff         1802  EOC677</span></span>
<span><span class="co">#&gt; 505        6      9 #fdbf6f          979  EOC677</span></span>
<span><span class="co">#&gt; 506        9     10 #cf8d30          223  EOC677</span></span>
<span><span class="co">#&gt; 507       10      1 #41ae76          314  EOC677</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subclonal-compositions">Subclonal compositions<a class="anchor" aria-label="anchor" href="#subclonal-compositions"></a>
</h3>
<p>Subclonal compositions are specified in a <a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="external-link">tidy</a> format,
where each row represents a subclone in a sample.</p>
<ul>
<li>
<code>sample</code> (string): specifies the sample ID.</li>
<li>
<code>subclone</code> (string): specifies the subclone ID.</li>
<li>
<code>clonalPrevalence</code> (number): specifies the clonal
prevalence of the subclone in the sample. The clonal prevalence is the
proportion of the subclone in the sample. The clonal prevalences in a
sample must sum to 1.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">$</span><span class="va">compositions</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  sample subclone clonalPrevalence patient</span></span>
<span><span class="co">#&gt; 98     EOC69_pOme1_DNA1        5           0.2250   EOC69</span></span>
<span><span class="co">#&gt; 99     EOC69_pOme1_DNA1        6           0.0965   EOC69</span></span>
<span><span class="co">#&gt; 100    EOC69_pOme1_DNA1       13           0.6660   EOC69</span></span>
<span><span class="co">#&gt; 101    EOC69_pOva1_DNA2        6           0.4175   EOC69</span></span>
<span><span class="co">#&gt; 102    EOC69_pOva1_DNA2       11           0.5225   EOC69</span></span>
<span><span class="co">#&gt; 103    EOC69_pOva1_DNA2       13           0.0360   EOC69</span></span>
<span><span class="co">#&gt; 104   EOC69_r1Vag1_DNA1        2           0.3845   EOC69</span></span>
<span><span class="co">#&gt; 105   EOC69_r1Vag1_DNA1       12           0.5970   EOC69</span></span>
<span><span class="co">#&gt; 880   EOC495_pLNL1_DNA1        4           0.5575  EOC495</span></span>
<span><span class="co">#&gt; 881   EOC495_pLNL1_DNA1        9           0.4405  EOC495</span></span>
<span><span class="co">#&gt; 882   EOC495_pLNL2_DNA1        4           0.4635  EOC495</span></span>
<span><span class="co">#&gt; 883   EOC495_pLNL2_DNA1        9           0.5345  EOC495</span></span>
<span><span class="co">#&gt; 884    EOC495_pLNR_DNA1        1           0.1595  EOC495</span></span>
<span><span class="co">#&gt; 885    EOC495_pLNR_DNA1        4           0.5060  EOC495</span></span>
<span><span class="co">#&gt; 886    EOC495_pLNR_DNA1        5           0.0350  EOC495</span></span>
<span><span class="co">#&gt; 887    EOC495_pLNR_DNA1        9           0.2950  EOC495</span></span>
<span><span class="co">#&gt; 888  EOC495_pOvaL6_DNA1        3           0.5320  EOC495</span></span>
<span><span class="co">#&gt; 889  EOC495_pOvaL6_DNA1        5           0.0665  EOC495</span></span>
<span><span class="co">#&gt; 890  EOC495_pOvaL6_DNA1        6           0.3995  EOC495</span></span>
<span><span class="co">#&gt; 891  EOC495_pOvaL7_DNA1        2           0.5440  EOC495</span></span>
<span><span class="co">#&gt; 892  EOC495_pOvaL7_DNA1        5           0.4390  EOC495</span></span>
<span><span class="co">#&gt; 893   EOC495_pPerL_DNA1        1           0.1155  EOC495</span></span>
<span><span class="co">#&gt; 894   EOC495_pPerL_DNA1        8           0.8850  EOC495</span></span>
<span><span class="co">#&gt; 1063   EOC677_pAsc_DNA1        2           0.3180  EOC677</span></span>
<span><span class="co">#&gt; 1064   EOC677_pAsc_DNA1        9           0.2440  EOC677</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ranks">Ranks<a class="anchor" aria-label="anchor" href="#ranks"></a>
</h3>
<p>The ranks in the example data set are used to indicate the time
points when the samples were acquired.</p>
<ul>
<li>
<code>rank</code> (integer): specifies the rank number. The zeroth
rank is reserved for the inferred root of the sample tree. However, you
are free to define a title for it.</li>
<li>
<code>title</code> (string): specifies the title for the rank.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span><span class="op">$</span><span class="va">ranks</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rank       title</span></span>
<span><span class="co">#&gt; 1    1   Diagnosis</span></span>
<span><span class="co">#&gt; 2    2   Diagnosis</span></span>
<span><span class="co">#&gt; 3    3 Diagnosis 2</span></span>
<span><span class="co">#&gt; 4    4 Diagnosis 3</span></span>
<span><span class="co">#&gt; 5    5    Interval</span></span>
<span><span class="co">#&gt; 6    6    Interval</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<div class="section level3">
<h3 id="basic-plotting">Basic plotting<a class="anchor" aria-label="anchor" href="#basic-plotting"></a>
</h3>
<p>The three tables are passed to the <code>jellyfisher</code> function
as a named list. The function generates an interactive Jellyfish plot
based on the input data. If the data set contains multiple patients, the
Jellyfisher htmlwidget shows navigation buttons to switch between
patients.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span>,</span>
<span>            width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">450</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:450px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"tables":{"samples":{"sample":["EOC69_pOme1_DNA1","EOC69_pOva1_DNA2","EOC69_r1Vag1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1"],"displayName":["pOme1","pOva1","r1Vag1","pLNL1","pLNL2","pLNR","pOvaL6","pOvaL7","pPerL","pAsc","pPer1","r2Asc","rAsc","p2Bow1_c","p2Ome1_c","p2OvaL1_c","p2Per1_cO","r1Bow1"],"rank":[1,1,10,1,1,1,1,1,1,1,1,11,9,3,3,3,3,10],"parent":["","","","","","","","","","","","EOC677_rAsc_DNA4","EOC677_pAsc_DNA1","","","","","EOC809_p2Bow1_c_DNA2"],"patient":["EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809"]},"phylogeny":{"subclone":[1,2,5,6,8,9,11,12,13,1,2,3,4,5,6,7,8,9,1,2,4,5,6,9,10,11,1,2,4,10,11,12,14,15],"parent":[-1,12,9,5,1,8,8,1,9,-1,5,6,1,7,5,1,7,4,-1,1,5,10,9,10,1,9,-1,12,10,15,10,1,12,1],"color":["#cccccc","#a6cee3","#ff99ff","#fdbf6f","#bbbb77","#cf8d30","#ff7f00","#3de4c5","#ff1aff","#cccccc","#a6cee3","#b2df8a","#cab2d6","#ff99ff","#fdbf6f","#fb9a99","#bbbb77","#cf8d30","#cccccc","#a6cee3","#cab2d6","#ff99ff","#fdbf6f","#cf8d30","#41ae76","#ff7f00","#cccccc","#a6cee3","#cab2d6","#41ae76","#ff7f00","#3de4c5","#9933ff","#3690c0"],"branchLength":[2742,478,68,244,2433,313,868,4762,1017,1426,184,246,2874,864,154,179,631,415,4961,239,437,1802,979,223,314,117,5787,1646,1020,567,1102,1544,2834,4452],"patient":["EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"compositions":{"sample":["EOC69_pOme1_DNA1","EOC69_pOme1_DNA1","EOC69_pOme1_DNA1","EOC69_pOva1_DNA2","EOC69_pOva1_DNA2","EOC69_pOva1_DNA2","EOC69_r1Vag1_DNA1","EOC69_r1Vag1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC495_pPerL_DNA1","EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC809_p2Bow1_c_DNA2","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1","EOC809_r1Bow1_DNA1"],"subclone":[5,6,13,6,11,13,2,12,4,9,4,9,1,4,5,9,3,5,6,2,5,1,8,2,9,11,1,9,11,4,5,1,2,5,6,9,10,11,4,15,1,4,10,12,15,11,15,1,2,12,12,14],"clonalPrevalence":[0.225,0.0965,0.666,0.4175,0.5225,0.036,0.3845,0.597,0.5575,0.4405,0.4635,0.5345,0.1595,0.506,0.035,0.295,0.532,0.0665,0.3995,0.544,0.439,0.1155,0.885,0.318,0.244,0.435,0.1695,0.3165,0.5145,0.95,0.034,0.054,0.033,0.2935,0.2325,0.2945,0.07199999999999999,0.021,0.6304999999999999,0.37,0.0205,0.0545,0.3365,0.0305,0.5580000000000001,0.67,0.322,0.0345,0.58,0.3855,0.098,0.9],"patient":["EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="plotting-with-custom-options">Plotting with custom options<a class="anchor" aria-label="anchor" href="#plotting-with-custom-options"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span><span class="va">jellyfisher_example_tables</span>,</span>
<span>            options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              sampleHeight <span class="op">=</span> <span class="fl">70</span>,</span>
<span>              sampleTakenGuide <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              tentacleWidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              showLegend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>            <span class="op">)</span>,</span>
<span>            width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:400px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"tables":{"samples":{"sample":["EOC69_pOme1_DNA1","EOC69_pOva1_DNA2","EOC69_r1Vag1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1"],"displayName":["pOme1","pOva1","r1Vag1","pLNL1","pLNL2","pLNR","pOvaL6","pOvaL7","pPerL","pAsc","pPer1","r2Asc","rAsc","p2Bow1_c","p2Ome1_c","p2OvaL1_c","p2Per1_cO","r1Bow1"],"rank":[1,1,10,1,1,1,1,1,1,1,1,11,9,3,3,3,3,10],"parent":["","","","","","","","","","","","EOC677_rAsc_DNA4","EOC677_pAsc_DNA1","","","","","EOC809_p2Bow1_c_DNA2"],"patient":["EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809"]},"phylogeny":{"subclone":[1,2,5,6,8,9,11,12,13,1,2,3,4,5,6,7,8,9,1,2,4,5,6,9,10,11,1,2,4,10,11,12,14,15],"parent":[-1,12,9,5,1,8,8,1,9,-1,5,6,1,7,5,1,7,4,-1,1,5,10,9,10,1,9,-1,12,10,15,10,1,12,1],"color":["#cccccc","#a6cee3","#ff99ff","#fdbf6f","#bbbb77","#cf8d30","#ff7f00","#3de4c5","#ff1aff","#cccccc","#a6cee3","#b2df8a","#cab2d6","#ff99ff","#fdbf6f","#fb9a99","#bbbb77","#cf8d30","#cccccc","#a6cee3","#cab2d6","#ff99ff","#fdbf6f","#cf8d30","#41ae76","#ff7f00","#cccccc","#a6cee3","#cab2d6","#41ae76","#ff7f00","#3de4c5","#9933ff","#3690c0"],"branchLength":[2742,478,68,244,2433,313,868,4762,1017,1426,184,246,2874,864,154,179,631,415,4961,239,437,1802,979,223,314,117,5787,1646,1020,567,1102,1544,2834,4452],"patient":["EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"compositions":{"sample":["EOC69_pOme1_DNA1","EOC69_pOme1_DNA1","EOC69_pOme1_DNA1","EOC69_pOva1_DNA2","EOC69_pOva1_DNA2","EOC69_pOva1_DNA2","EOC69_r1Vag1_DNA1","EOC69_r1Vag1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC495_pPerL_DNA1","EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC809_p2Bow1_c_DNA2","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1","EOC809_r1Bow1_DNA1"],"subclone":[5,6,13,6,11,13,2,12,4,9,4,9,1,4,5,9,3,5,6,2,5,1,8,2,9,11,1,9,11,4,5,1,2,5,6,9,10,11,4,15,1,4,10,12,15,11,15,1,2,12,12,14],"clonalPrevalence":[0.225,0.0965,0.666,0.4175,0.5225,0.036,0.3845,0.597,0.5575,0.4405,0.4635,0.5345,0.1595,0.506,0.035,0.295,0.532,0.0665,0.3995,0.544,0.439,0.1155,0.885,0.318,0.244,0.435,0.1695,0.3165,0.5145,0.95,0.034,0.054,0.033,0.2935,0.2325,0.2945,0.07199999999999999,0.021,0.6304999999999999,0.37,0.0205,0.0545,0.3365,0.0305,0.5580000000000001,0.67,0.322,0.0345,0.58,0.3855,0.098,0.9],"patient":["EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC69","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":70,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":3,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":false,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"none","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="plotting-a-single-patient">Plotting a single patient<a class="anchor" aria-label="anchor" href="#plotting-a-single-patient"></a>
</h3>
<p>When plotting multiple patients, Jellyfisher shows buttons (Previous
and Next) to navigate between patients. When the data contains only one
patient, these buttons are hidden. The package also provides a
<code>select_patients</code> function to filter the data set with
ease.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jellyfisher_example_tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_patients.html">select_patients</a></span><span class="op">(</span><span class="st">"EOC677"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:400px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"tables":{"samples":{"sample":["EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4"],"displayName":["pAsc","pPer1","r2Asc","rAsc"],"rank":[1,1,11,9],"parent":["","","EOC677_rAsc_DNA4","EOC677_pAsc_DNA1"],"patient":["EOC677","EOC677","EOC677","EOC677"]},"phylogeny":{"subclone":[1,2,4,5,6,9,10,11],"parent":[-1,1,5,10,9,10,1,9],"color":["#cccccc","#a6cee3","#cab2d6","#ff99ff","#fdbf6f","#cf8d30","#41ae76","#ff7f00"],"branchLength":[4961,239,437,1802,979,223,314,117],"patient":["EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677"]},"compositions":{"sample":["EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pAsc_DNA1","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_pPer1_DNA","EOC677_r2Asc_DNA","EOC677_r2Asc_DNA","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4","EOC677_rAsc_DNA4"],"subclone":[2,9,11,1,9,11,4,5,1,2,5,6,9,10,11],"clonalPrevalence":[0.318,0.244,0.435,0.1695,0.3165,0.5145,0.95,0.034,0.054,0.033,0.2935,0.2325,0.2945,0.07199999999999999,0.021],"patient":["EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677","EOC677"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="adjusting-the-sample-tree-structure">Adjusting the sample tree structure<a class="anchor" aria-label="anchor" href="#adjusting-the-sample-tree-structure"></a>
</h2>
<p>The sample trees in the example data set were constructed as
follows:</p>
<p><em>“For each sample, we checked whether an earlier time point
included exactly one sample from the same anatomical location. If such a
sample existed, it was assigned as the parent; otherwise, the inferred
root was used as the parent.”</em></p>
<p>However, this mechanistic approach may not always produce credible
sample trees.</p>
<div class="section level3">
<h3 id="changing-parent">Changing parent<a class="anchor" aria-label="anchor" href="#changing-parent"></a>
</h3>
<p>The <em>r1Bow1</em> (bowel) sample in the following jellyfish plot is
derived from an earlier bowel sample <em>p2Bow1_c</em>, which has no
traces of the subclone 12.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jellyfisher_example_tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_patients.html">select_patients</a></span><span class="op">(</span><span class="st">"EOC809"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:600px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"tables":{"samples":{"sample":["EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1"],"displayName":["p2Bow1_c","p2Ome1_c","p2OvaL1_c","p2Per1_cO","r1Bow1"],"rank":[3,3,3,3,10],"parent":["","","","","EOC809_p2Bow1_c_DNA2"],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809"]},"phylogeny":{"subclone":[1,2,4,10,11,12,14,15],"parent":[-1,12,10,15,10,1,12,1],"color":["#cccccc","#a6cee3","#cab2d6","#41ae76","#ff7f00","#3de4c5","#9933ff","#3690c0"],"branchLength":[5787,1646,1020,567,1102,1544,2834,4452],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"compositions":{"sample":["EOC809_p2Bow1_c_DNA2","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1","EOC809_r1Bow1_DNA1"],"subclone":[4,15,1,4,10,12,15,11,15,1,2,12,12,14],"clonalPrevalence":[0.6304999999999999,0.37,0.0205,0.0545,0.3365,0.0305,0.5580000000000001,0.67,0.322,0.0345,0.58,0.3855,0.098,0.9],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script><p>Using the <code>set_parents</code> function, we can adjust the parent
of the <em>r1Bow1</em> sample to be <em>p2Per1_cO</em> (peritoneum),
which is a possible source of the metastasis due to its proximity. The
high prevalence of subclone 12 in this sample suggests that it is the
likely source of the metastasis in the <em>r1Bow1</em> sample.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jellyfisher_example_tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_patients.html">select_patients</a></span><span class="op">(</span><span class="st">"EOC809"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_parents.html">set_parents</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EOC809_r1Bow1_DNA1"</span> <span class="op">=</span> <span class="st">"EOC809_p2Per1_cO_DNA2"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:600px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"tables":{"samples":{"sample":["EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1"],"displayName":["p2Bow1_c","p2Ome1_c","p2OvaL1_c","p2Per1_cO","r1Bow1"],"rank":[3,3,3,3,10],"parent":["","","","","EOC809_p2Per1_cO_DNA2"],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809"]},"phylogeny":{"subclone":[1,2,4,10,11,12,14,15],"parent":[-1,12,10,15,10,1,12,1],"color":["#cccccc","#a6cee3","#cab2d6","#41ae76","#ff7f00","#3de4c5","#9933ff","#3690c0"],"branchLength":[5787,1646,1020,567,1102,1544,2834,4452],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"compositions":{"sample":["EOC809_p2Bow1_c_DNA2","EOC809_p2Bow1_c_DNA2","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2Ome1_c_DNA1","EOC809_p2OvaL1_c_DNA6","EOC809_p2OvaL1_c_DNA6","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_p2Per1_cO_DNA2","EOC809_r1Bow1_DNA1","EOC809_r1Bow1_DNA1"],"subclone":[4,15,1,4,10,12,15,11,15,1,2,12,12,14],"clonalPrevalence":[0.6304999999999999,0.37,0.0205,0.0545,0.3365,0.0305,0.5580000000000001,0.67,0.322,0.0345,0.58,0.3855,0.098,0.9],"patient":["EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809","EOC809"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="changing-topology">Changing topology<a class="anchor" aria-label="anchor" href="#changing-topology"></a>
</h3>
<p>While ranks (the columns) can indicate the time points when the
samples were acquired, they can also be used to simply show the sample’s
depth in the sample tree. For instance, the following plot shows all the
samples on the same rank, indicating that they were diagnostic samples
acquired at the same time.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jellyfisher_example_tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_patients.html">select_patients</a></span><span class="op">(</span><span class="st">"EOC495"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">650</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:650px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"tables":{"samples":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1"],"displayName":["pLNL1","pLNL2","pLNR","pOvaL6","pOvaL7","pPerL"],"rank":[1,1,1,1,1,1],"parent":["","","","","",""],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"phylogeny":{"subclone":[1,2,3,4,5,6,7,8,9],"parent":[-1,5,6,1,7,5,1,7,4],"color":["#cccccc","#a6cee3","#b2df8a","#cab2d6","#ff99ff","#fdbf6f","#fb9a99","#bbbb77","#cf8d30"],"branchLength":[1426,184,246,2874,864,154,179,631,415],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"compositions":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC495_pPerL_DNA1"],"subclone":[4,9,4,9,1,4,5,9,3,5,6,2,5,1,8],"clonalPrevalence":[0.5575,0.4405,0.4635,0.5345,0.1595,0.506,0.035,0.295,0.532,0.0665,0.3995,0.544,0.439,0.1155,0.885],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"ranks":{"rank":[1,2,3,4,5,6,7,8,9,10,11,12,13],"title":["Diagnosis","Diagnosis","Diagnosis 2","Diagnosis 3","Interval","Interval","Interval 2","Interval 3","Relapse","Relapse","Relapse 2","Relapse 3","Relapse 4"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script><p>However, one can argue that the LN (lymph node) samples represent a
later development in the disease, and thus, they should be placed on a
later rank. We can remove the existing ranks, define new parent-child
relationships, and let Jellyfisher assign the ranks based on the sample
tree depth.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="va">jellyfisher_example_tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_patients.html">select_patients</a></span><span class="op">(</span><span class="st">"EOC495"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove existing ranks. The ranks will be assigned automatically based</span></span>
<span><span class="co"># on samples' depths in the sample tree.</span></span>
<span><span class="va">tables</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">rank</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># Rank titles should be removed as well because they are no longer valid.</span></span>
<span><span class="va">tables</span><span class="op">$</span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_parents.html">set_parents</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EOC495_pLNL1_DNA1"</span> <span class="op">=</span> <span class="st">"EOC495_pLNR_DNA1"</span>,</span>
<span>                   <span class="st">"EOC495_pLNL2_DNA1"</span> <span class="op">=</span> <span class="st">"EOC495_pLNL1_DNA1"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-4018eef1a407a0df6b52" style="width:100%;height:500px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"tables":{"samples":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1"],"displayName":["pLNL1","pLNL2","pLNR","pOvaL6","pOvaL7","pPerL"],"rank":[null,null,null,null,null,null],"parent":["EOC495_pLNR_DNA1","EOC495_pLNL1_DNA1","","","",""],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"phylogeny":{"subclone":[1,2,3,4,5,6,7,8,9],"parent":[-1,5,6,1,7,5,1,7,4],"color":["#cccccc","#a6cee3","#b2df8a","#cab2d6","#ff99ff","#fdbf6f","#fb9a99","#bbbb77","#cf8d30"],"branchLength":[1426,184,246,2874,864,154,179,631,415],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"compositions":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC495_pPerL_DNA1"],"subclone":[4,9,4,9,1,4,5,9,3,5,6,2,5,1,8],"clonalPrevalence":[0.5575,0.4405,0.4635,0.5345,0.1595,0.506,0.035,0.295,0.532,0.0665,0.3995,0.544,0.439,0.1155,0.885],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"ranks":null},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script><p>If we think that the lymph node samples represent an even later
development, we can manually assign ranks to the samples. The
<code>set_ranks</code> function provides an easy way to do this.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tables</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_parents.html">set_parents</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EOC495_pLNL1_DNA1"</span> <span class="op">=</span> <span class="st">"EOC495_pLNR_DNA1"</span>,</span>
<span>                   <span class="st">"EOC495_pLNL2_DNA1"</span> <span class="op">=</span> <span class="st">"EOC495_pLNL1_DNA1"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_ranks.html">set_ranks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EOC495_pLNR_DNA1"</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 <span class="st">"EOC495_pLNL1_DNA1"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 <span class="st">"EOC495_pLNL2_DNA1"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>            default <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-5b1b2f4ad92281566982" style="width:100%;height:400px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"tables":{"samples":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1"],"displayName":["pLNL1","pLNL2","pLNR","pOvaL6","pOvaL7","pPerL"],"rank":[3,4,2,1,1,1],"parent":["EOC495_pLNR_DNA1","EOC495_pLNL1_DNA1","","","",""],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"phylogeny":{"subclone":[1,2,3,4,5,6,7,8,9],"parent":[-1,5,6,1,7,5,1,7,4],"color":["#cccccc","#a6cee3","#b2df8a","#cab2d6","#ff99ff","#fdbf6f","#fb9a99","#bbbb77","#cf8d30"],"branchLength":[1426,184,246,2874,864,154,179,631,415],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"compositions":{"sample":["EOC495_pLNL1_DNA1","EOC495_pLNL1_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNL2_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pLNR_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL6_DNA1","EOC495_pOvaL7_DNA1","EOC495_pOvaL7_DNA1","EOC495_pPerL_DNA1","EOC495_pPerL_DNA1"],"subclone":[4,9,4,9,1,4,5,9,3,5,6,2,5,1,8],"clonalPrevalence":[0.5575,0.4405,0.4635,0.5345,0.1595,0.506,0.035,0.295,0.532,0.0665,0.3995,0.544,0.439,0.1155,0.885],"patient":["EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495","EOC495"]},"ranks":null},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":false},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="handling-non-aberrant-cells">Handling non-aberrant cells<a class="anchor" aria-label="anchor" href="#handling-non-aberrant-cells"></a>
</h2>
<p>Typically in tumor evolution studies, the focus is on the subclonal
compositions of the tumor cells. Thus, the root node in the phylogenetic
tree represents the founding clone. However, the data may also contain
non-aberrant cells, i.e., the tumor purity is less than 100%. For these
cases, the <code>normalsInPhylogenyRoot</code> option instructs
Jellyfisher to treat the root node as non-aberrant cells. The option has
two consequences: (1) No tentacles are drawn between the root subclones,
and (2) the root subclone is colored as white when the phylogeny-aware
color scheme is used.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subclone N at the root represents the non-aberrant cells.</span></span>
<span><span class="co"># The letter N has no special meaning in Jellyfisher.</span></span>
<span><span class="va">non_aberrant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  compositions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>    subclone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"N"</span>, <span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    clonalPrevalence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  phylogeny <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    subclone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"N"</span>, <span class="st">"1"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">non_aberrant</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    normalsAtPhylogenyRoot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">350</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-25c3e940e6859592f801" style="width:100%;height:350px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"tables":{"samples":{"sample":["A","B"]},"compositions":{"sample":["A","A","A","B","B","B"],"subclone":["N","1","2","N","1","2"],"clonalPrevalence":[0.2,0.4,0.4,0.3,0.3,0.4]},"phylogeny":{"subclone":["N","1","2"],"parent":[null,"N","1"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":true},"controls":"closed"},"evals":[],"jsHooks":[]}</script><p>In the above plot, the root clone, which represents the non-aberrant
cells, is hidden from the inferred root sample. However, sometimes a
patient may have multiple independent clones, and in these cases the
root clone is shown:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the parent of subclone 2 to N</span></span>
<span><span class="va">non_aberrant</span><span class="op">$</span><span class="va">phylogeny</span><span class="op">$</span><span class="va">parent</span><span class="op">[</span><span class="va">non_aberrant</span><span class="op">$</span><span class="va">phylogeny</span><span class="op">$</span><span class="va">subclone</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"N"</span></span>
<span></span>
<span><span class="va">non_aberrant</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/jellyfisher.html">jellyfisher</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    normalsAtPhylogenyRoot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="fl">350</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-3f27c09be0c60bb52829" style="width:100%;height:350px;" class="jellyfisher html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f27c09be0c60bb52829">{"x":{"tables":{"samples":{"sample":["A","B"]},"compositions":{"sample":["A","A","A","B","B","B"],"subclone":["N","1","2","N","1","2"],"clonalPrevalence":[0.2,0.4,0.4,0.3,0.3,0.4]},"phylogeny":{"subclone":["N","1","2"],"parent":[null,"N","N"]}},"options":{"crossingWeight":10,"pathLengthWeight":2,"orderMismatchWeight":2,"bundleMismatchWeight":3,"divergenceWeight":4,"bellTipShape":0.1,"bellTipSpread":0.5,"bellStrokeWidth":1,"bellStrokeDarkening":0.6,"bellPlateauPos":0.75,"sampleHeight":110,"sampleWidth":90,"inferredSampleHeight":120,"gapHeight":60,"sampleSpacing":60,"columnSpacing":90,"tentacleWidth":2,"tentacleSpacing":5,"inOutCPDistance":0.3,"bundleCPDistance":0.6,"sampleFontSize":12,"showLegend":true,"phylogenyColorScheme":true,"phylogenyHueOffset":0,"sampleTakenGuide":"text","showRankTitles":true,"normalsAtPhylogenyRoot":true},"controls":"closed"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] jellyfisher_0.0.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] vctrs_0.6.5       cli_3.6.3         knitr_1.49        rlang_1.1.5      </span></span>
<span><span class="co">#&gt;  [5] xfun_0.50         stringi_1.8.4     generics_0.1.3    textshaping_1.0.0</span></span>
<span><span class="co">#&gt;  [9] jsonlite_1.8.9    glue_1.8.0        htmltools_0.5.8.1 ragg_1.3.3       </span></span>
<span><span class="co">#&gt; [13] sass_0.4.9        rmarkdown_2.29    tibble_3.2.1      evaluate_1.0.3   </span></span>
<span><span class="co">#&gt; [17] jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.10       lifecycle_1.0.4  </span></span>
<span><span class="co">#&gt; [21] stringr_1.5.1     compiler_4.4.2    dplyr_1.1.4       fs_1.6.5         </span></span>
<span><span class="co">#&gt; [25] pkgconfig_2.0.3   htmlwidgets_1.6.4 systemfonts_1.2.1 digest_0.6.37    </span></span>
<span><span class="co">#&gt; [29] R6_2.5.1          tidyselect_1.2.1  pillar_1.10.1     magrittr_2.0.3   </span></span>
<span><span class="co">#&gt; [33] bslib_0.8.0       tools_4.4.2       pkgdown_2.1.1     cachem_1.1.0     </span></span>
<span><span class="co">#&gt; [37] desc_1.4.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kari Lavikka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
